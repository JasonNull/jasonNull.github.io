---
title: 分布式理论
date: 2018-06-24 16:03:45
tags:
- 分布式
catrgories:
- 分布式
toc: true
---
#### CAP
consistency，availbility，partion tolerance，通常是cp，或者ap
#### BASE
Basic Available，Soft State，Eventually consistency
<!-- more -->

#### 2pc
先发送prepare请求，参与者都回复ok，则进行提交，某个参与者不ok，则进行全局回滚。

#### tcc
1. try阶段，业务系统做检测，以及资源预留
2. Confirm阶段，对业务系统做提交确认（默认confrim阶段不会出错）
3. Cancel阶段，主要是Confirm阶段执行错误，回滚更改，资源释放

转账例子：
1. try阶段，把A和B的账户冻结
2. confirm阶段，A中扣钱，再转给B，并且完成之后会释放资源
3. cancel阶段，如果confirm中转账失败，则调用远程的cancel方法
tcc是一种业务的补偿，不是数据库底层的支持。

#### 分布式一致性
1. gossip，Cassandra使用
2. paxos，zk，ob使用